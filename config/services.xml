<?xml version="1.0" encoding="UTF-8"?>
<container xmlns="http://symfony.com/schema/dic/services"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://symfony.com/schema/dic/services http://symfony.com/schema/dic/services/services-1.0.xsd">

    <parameters>
        <!-- should really state where the config dir is explictly -->
        <parameter key="codewords.dict">config/dict-3</parameter>
        <parameter key="codewords.dictionary.class">Codewords\Dictionary\SortedDictionary</parameter>
        <parameter key="codewords.board_reader.class">Codewords\Board\CsvBoardReader</parameter>
        <parameter key="codewords.solver.class">Codewords\Solver\StrategyB</parameter>
        <parameter key="codewords.renderer.class">Codewords\Board\HtmlTableBoardRenderer</parameter>
        <parameter key="codewords.board_loader.class">Codewords\BoardLoader</parameter>
    </parameters>

    <services>
        <service id="game" class="Codewords\Game">
            <argument type="service" id="dictionary" />
        </service>

        <service id="loader" class="%codewords.board_loader.class%"/>

        <service id="dictionary" class="%codewords.dictionary.class%">
            <argument>%codewords.dict%</argument>
        </service>

        <service id="stats_repository" class="Codewords\Stats\StatsRepository"/>

        <service id="finder_factory" class="Codewords\Solver\FinderFactory">
            <argument type="service" id="stats_repository" />
            <argument type="service" id="dictionary" />
        </service>
        
        <!-- 
            not sure this is a service - a reader factory would be more flexible 
            as it could produce different IBoardReaders depending on the data to be read
        -->
        <service id="board_reader" class="%codewords.board_reader.class%"/>

        <service id="board_factory" class="Codewords\Board\BoardFactory" />

        <service id="strategy" class="%codewords.solver.class%">
            <argument type="service" id="cell_options" />
        </service>

        <service id="cell_options" class="Codewords\Solver\CellOptions">
            <argument type="service" id="game" />
            <argument type="service" id="finder_factory" />
        </service>

        <service id="renderer" class="%codewords.renderer.class%"/>

    </services>
</container>
